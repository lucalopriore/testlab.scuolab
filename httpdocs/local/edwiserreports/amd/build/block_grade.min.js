"use strict";define(["jquery","core/ajax","core/templates","./chart/apexcharts","./common","./defaultconfig","./select2"],function(e,t,n,r,a,o){var s=null,c={course:0,student:0},i={chart:{type:"pie",height:350},fill:{type:"solid"},legend:{position:"bottom",offsetY:0},colors:["#007bff","#6c757d","#28a745","#dc3545","#ffc107","#17a2b8"],noData:{text:M.util.get_string("nographdata","local_edwiserreports")}},d={PANEL:"#gradeblock",COURSE:".course-select",STUDENT:".student-select",GRAPH:".graph",GRAPHLABEL:".graph-label",FORMFILTER:'.download-links [name="filter"]',FILTERS:".filters"},l={GET_STUDENTS:function(e){return t.call([{methodname:"local_edwiserreports_get_students_of_course",args:{courseid:e}}],!1)[0]},GET_GRAPH_DATA:function(){return e.ajax({url:o.requestUrl,type:o.requestType,dataType:o.requestDataType,data:{action:"get_grade_graph_data_ajax",secret:M.local_edwiserreports.secret,data:JSON.stringify({filter:c})}})}};function u(){var t;a.loader.show(d.PANEL);var n=Object.keys(c).map(function(e){return c[e]}).join("-");e(d.PANEL).find(d.FORMFILTER).val(n),l.GET_GRAPH_DATA().done(function(n){(t=Object.assign({},i)).labels=n.labels,t.series=n.grades,e(d.PANEL).find(d.GRAPHLABEL).text(n.header),function(e,t){null!==s&&s.destroy(),(s=new r(e.get(0),t)).render(),setTimeout(function(){a.loader.hide(d.PANEL)},1e3)}(e(d.PANEL).find(d.GRAPH),t)}),a.loader.hide(d.PANEL)}return{init:function(t){0!=e(d.PANEL).length&&(e(d.PANEL).find(".singleselect").select2(),e("body").on("change","".concat(d.PANEL," ").concat(d.COURSE),function(){courseid=parseInt(e(this).val()),c.course=courseid,c.student=0,l.GET_STUDENTS(courseid).done(function(t){e(d.PANEL).find(d.STUDENT).select2("destroy"),n.render("local_edwiserreports/studentengagement/students_filter",{students:t}).done(function(t,r){n.replaceNode(e(d.PANEL).find(d.STUDENT),t,r),e(d.PANEL).find(d.STUDENT).select2()})}),u()}),e("body").on("change","".concat(d.PANEL," ").concat(d.STUDENT),function(){c.student=parseInt(e(this).val()),u()}),u())}}});
//# sourceMappingURL=block_grade.min.js.map
